# Руководство по миграции БД

## Изменения в версии: Хранение книг в БД

### Что изменилось?
- Теперь книги сохраняются прямо в БД SQLite вместо файловой системы
- Добавлены новые поля: `file_data` (BLOB), `file_name` (TEXT)
- Поле `file_path` стало nullable для обратной совместимости

### Как выполнить миграцию?

1. **Остановите приложение** (если запущено)

2. **Сделайте резервную копию БД**:
```bash
cp ./data/database.db ./data/database.db.backup
```

3. **Запустите скрипт миграции**:
```bash
cd backend
python migrate_db.py
```

4. **Перезапустите приложение**

### Откат миграции

Если что-то пошло не так:
```bash
cd backend
rm ./data/database.db
cp ./data/database.db.backup ./data/database.db
```

### Преимущества нового подхода

✅ Не нужна отдельная папка для книг  
✅ Проще работа с Docker  
✅ Проще бэкапы (один файл БД)  
✅ Автоматическое удаление файлов при удалении книги  

### Совместимость

- Старые книги (в файловой системе) продолжат работать
- Новые книги будут сохраняться в БД
